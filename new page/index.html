<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>survey create-form</title>
    <link rel="icon" href="/maynooth.png" type="image/png" />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap");

      *,
      *:before,
      *:after {
        box-sizing: border-box;
      }

      *,
      body,
      html {
        &::-webkit-scrollbar {
          background-color: #1e1f26;
          height: 20px;
          width: 20px;
        }

        &::-webkit-scrollbar-thumb {
          background: #383d4d;
          border-radius: 99em;
          border: 6px solid #1e1f26;
        }
      }

      html,
      body {
        margin: 0;
        padding: 0;
      }

      h1 {
        font-size: clamp(20px, 2.5vw, 36px);
        color: rgba(255, 255, 255, 0.8);
        font-weight: 600;
        text-align: center;
        margin-top: 20px;
      }

      img {
        display: block;
        width: 100%;
        max-width: 100%;
        margin-bottom: 1.5rem;
      }

      ul {
        padding: 0;
        margin: 0;
        display: block;
        width: 100%;
        overflow-y: hidden;
        overflow-x: auto;
        white-space: nowrap;
        text-align: center;
        scroll-behavior: smooth;
        position: relative;
        bottom: 0;
      }

      li {
        position: -webkit-sticky;
        position: sticky;
        border-radius: 1px;
        left: 0;
        width: min(70vw, 350px);
        height: 300px;
        display: inline-block;
        text-align: center;
        background-color: #16171f;
        color: #9b9dad;
        padding: 1.5rem;
        font-size: clamp(18px, 2.5vw, 22px);
        box-shadow: -50px 0 20px 0 rgba(0, 0, 0, 0.25);
        margin-left: 0px;
        margin-top: 2%;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: #ffffff;
        background-image: url("maynooth pic.jpg"); /* Add your background image URL here */
        background-size: cover; /* Ensures the background image covers the entire area */
        background-repeat: no-repeat; /* Prevents the background image from repeating */
        background-position: center center; /* Centers the background image */
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: flex-start; /* Align items to the start */
        min-height: 100vh;
        padding: 20px; /* Added padding */
      }

      #search {
        width: 100%;
        padding: 10px;
        box-sizing: border-box;
        background-color: #b0b0b0;
        border: none;
        outline: none;
        font-size: 18px;
        margin-top: 25px;
      }

      .links {
        display: flex;
        justify-content: flex-end;
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 999; /* Ensures it's above other content */
      }

      .links img {
        width: 30px; /* Adjust the width as needed */
        height: auto; /* Maintain aspect ratio */
        margin-left: 10px; /* Add some space between the images */
        cursor: pointer; /* Add cursor pointer */
        will-change: transform; /* Improve performance */
        transition: transform 0.3s ease-in-out; /* Add transition effect */
      }

      .links img:hover {
        transform: scale(1.3); /* Scale up on hover */
      }

      .create-link,
      .rec {
        height: 100px;
        width: 300px;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        font: 1.5rem sans-serif;
        cursor: pointer;
        will-change: transform;
        margin-left: 40%;
        margin-top: 25px;
        background-color: black; /* Added */
        color: white; /* Added */
        transition: transform 0.3s ease-in-out; /* Add transition effect */
      }

      .create-link a,
      .rec a {
        text-decoration: none; /* Added */
        color: inherit; /* Added to ensure the link text color matches the surrounding text */
      }

      .create-link::before,
      .create-link::after,
      .rec::before,
      .rec::after {
        position: absolute;
        top: 0;
        left: 0;
        content: "";
        display: block;
        background-color: rgb(112, 112, 112);
        transition: all 250ms ease-in-out;
      }

      .create-link::before,
      .rec::before {
        width: 2px;
        height: 100px;
        box-shadow: 298px 0 rgb(112, 112, 112);
      }

      .create-link::after,
      .rec::after {
        height: 2px;
        width: 300px;
        box-shadow: 0 98px rgb(112, 112, 112);
      }

      .create-link:hover::before,
      .rec:hover::before {
        left: -10px;
        box-shadow: 318px 0 rgb(112, 112, 112);
      }

      .create-link:hover::after,
      .rec:hover::after {
        top: -10px;
        box-shadow: 0 118px rgb(112, 112, 112);
      }

      .dark-mode-switch {
        position: fixed;
        top: 10px;
        left: 10px;
        width: 44px;
        height: 25px;
        background-color: #ccc;
        border-radius: 15px;
        cursor: pointer;
      }

      .dark-mode-switch::after {
        content: "";
        position: absolute;
        top: 3px;
        left: 2px;
        width: 20px;
        height: 20px;
        background-color: #fff;
        border-radius: 50%;
        transition: transform 0.3s ease-in-out;
      }

      input[type="checkbox"]:checked + .dark-mode-switch::after {
        transform: translateX(20px);
      }

      /* Dark mode styles */
      body.dark-mode {
        background-color: #000000;
        color: #fff;
      }

      .dark-mode-switch {
        background-color: #888;
      }

      .dark-mode-switch::after {
        background-color: #000000;
      }

      /* Center the logo */
      #logo {
        display: block;
        margin-top: 20px;
        width: 500px; /* Adjust width as needed */
        height: auto; /* Maintain aspect ratio */
        text-align: center; /* Center the image */
      }

      .dropdown {
        position: absolute;
        width: 100%;
        background-color: rgb(137, 137, 137);
        border: 1px solid #ccc;
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
        top: calc(10% + 5px); /* Position it just below the search bar */
      }

      .dropdown-item {
        padding: 10px;
        cursor: pointer;
      }

      .dropdown-item:hover {
        background-color: #cacaca;
      }

      .hidden {
        display: none;
      }
    </style>
  </head>

  <body>
    <input type="checkbox" id="darkModeSwitch" />
    <label for="darkModeSwitch" class="dark-mode-switch"></label>
    <div class="links">
      <a href="settings.html">
        <img src="gear.png" alt="Settings" />
      </a>
      <img src="user.png" alt="Profile" />
    </div>

    <input type="text" id="search" placeholder="Search..." />

    <div id="dropdown" class="dropdown"></div>

    <a href="https://www.maynoothuniversity.ie">
      <img src="maynooth.png" alt="Logo" id="logo" />
    </a>

    <div class="create-link">
      <a href="create-form.html">Create Questionnaire</a>
    </div>
    <div class="bar"></div>
    <div class="rec">
      <a onclick="viewRecentlyViewed()">Recently viewed</a>
    </div>

    <ul id="questionnairesList"></ul>

    <script>
      // JavaScript code for dark mode toggle
      const darkModeSwitch = document.getElementById("darkModeSwitch");
      darkModeSwitch.addEventListener("change", () => {
        document.body.classList.toggle("dark-mode");
      });

      document.addEventListener("DOMContentLoaded", function () {
        const questionnairesList =
          document.getElementById("questionnairesList");
        const searchInput = document.getElementById("search");
        const dropdown = document.getElementById("dropdown");

        function renderQuestionnaires(filter = "") {
          const questionnaires =
            JSON.parse(localStorage.getItem("questionnaires")) || [];
          questionnairesList.innerHTML = "";

          const filteredQuestionnaires = questionnaires.filter((q) =>
            q.title.toLowerCase().includes(filter.toLowerCase())
          );

          filteredQuestionnaires.forEach((questionnaire, index) => {
            const li = document.createElement("li");
            li.textContent = `Questionnaire ${index + 1}: ${
              questionnaire.title
            }`;
            li.style.cursor = "pointer";

            const img = document.createElement("img");
            img.src = "images.jpeg";
            img.alt = "Questionnaire Image";
            li.appendChild(img);

            li.onclick = function () {
              viewQuestionnaire(index);
            };

            const deleteBtn = document.createElement("button");
            deleteBtn.textContent = "x";
            deleteBtn.className = "delete-btn";
            deleteBtn.addEventListener("click", function (event) {
              event.stopPropagation();
              deleteQuestionnaire(index);
            });

            li.appendChild(deleteBtn);
            questionnairesList.appendChild(li);
          });
        }

        function deleteQuestionnaire(index) {
          let questionnaires =
            JSON.parse(localStorage.getItem("questionnaires")) || [];
          questionnaires.splice(index, 1);
          localStorage.setItem(
            "questionnaires",
            JSON.stringify(questionnaires)
          );
          renderQuestionnaires(searchInput.value);
        }

        function updateDropdown(searchTerm) {
          dropdown.innerHTML = "";

          const questionnaires =
            JSON.parse(localStorage.getItem("questionnaires")) || [];
          const filteredQuestionnaires = questionnaires.filter((q) =>
            q.title.toLowerCase().includes(searchTerm.toLowerCase())
          );

          filteredQuestionnaires.forEach((questionnaire, index) => {
            const dropdownItem = document.createElement("div");
            dropdownItem.classList.add("dropdown-item");
            dropdownItem.textContent = questionnaire.title;

            dropdownItem.addEventListener("click", () => {
              viewQuestionnaire(index);
            });

            dropdown.appendChild(dropdownItem);
          });

          dropdown.style.display =
            filteredQuestionnaires.length > 0 ? "block" : "none";
        }

        searchInput.addEventListener("input", function () {
          updateDropdown(searchInput.value);
          renderQuestionnaires(searchInput.value);
        });

        document.addEventListener("click", function (event) {
          if (!event.target.matches("#search")) {
            dropdown.style.display = "none";
          }
        });

        renderQuestionnaires();
      });

      function viewQuestionnaire(index) {
        const questionnaires =
          JSON.parse(localStorage.getItem("questionnaires")) || [];
        const selectedQuestionnaire = questionnaires[index];

        if (selectedQuestionnaire) {
          localStorage.setItem("recentlyViewed", index); // Store the index in localStorage
          window.location.href = `view.html?id=${index}`;
        }
      }

      function viewRecentlyViewed() {
        const recentlyViewedIndex = localStorage.getItem("recentlyViewed");

        if (recentlyViewedIndex !== null) {
          window.location.href = `view.html?id=${recentlyViewedIndex}`;
        } else {
          alert("No recently viewed questionnaire found.");
        }
      }
    </script>
  </body>
</html>
